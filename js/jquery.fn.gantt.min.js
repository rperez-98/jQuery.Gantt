!function(O){"use strict";function n(e,t){var a=new Date(parseInt(t,10));a.setHours(0,0,0,0);var n=O(e).attr("id")||"",s=n.indexOf("-")+1,i=new Date(parseInt(n.substring(s,n.length),10));return i.setHours(0,0,0,0),a.getTime()===i.getTime()}function s(e,t){var a=new Date(parseInt(t,10)),n=a.getFullYear(),s=a.getWeekOfYear(),i=a.getMonth();11===i&&1===s?n++:!i&&51<s&&n--,a=n+"-"+s;var l=O(e).attr("id")||"",o=l.indexOf("-")+1;return a===l.substring(o,l.length)}function i(e,t){var a=new Date(parseInt(t,10));a=a.getFullYear()+"-"+a.getMonth();var n=O(e).attr("id")||"",s=n.indexOf("-")+1;return a===n.substring(s,n.length)}O.expr.pseudos.findday=O.expr.createPseudo?O.expr.createPseudo(function(t){return function(e){return n(e,t)}}):function(e,t,a){return n(e,a[3])},O.expr.pseudos.findweek=O.expr.createPseudo?O.expr.createPseudo(function(t){return function(e){return s(e,t)}}):function(e,t,a){return s(e,a[3])},O.expr[":"].findmonth=O.expr.createPseudo?O.expr.createPseudo(function(t){return function(e){return i(e,t)}}):function(e,t,a){return i(e,a[3])},Date.prototype.getWeekId=function(){var e=this.getFullYear(),t=this.getWeekOfYear(),a=this.getMonth();return 11===a&&1===t?e++:!a&&51<t&&e--,"dh-"+e+"-"+t},Date.prototype.getRepDate=function(e){switch(e){case"hours":return this.getTime();case"weeks":return this.getDayForWeek().getTime();case"months":return new Date(this.getFullYear(),this.getMonth(),1).getTime();case"days":default:return this.getTime()}},Date.prototype.getDayOfYear=function(){var e=this.getFullYear();return(Date.UTC(e,this.getMonth(),this.getDate())-Date.UTC(e,0,0))/864e5};Date.prototype.getWeekOfYear=function(){var e=this.getFullYear(),t=this.getMonth(),a=this.getDate(),n=this.getDay(),s=4-n;return n<1&&(s-=7),s+7<3&&(s+=7),Math.ceil(new Date(e,t,a+s).getDayOfYear()/7)},Date.prototype.getDayForWeek=function(){var e=this.getDay(),t=1+(e<1?-7:0)-e;return new Date(this.getFullYear(),this.getMonth(),this.getDate()+t)},O.fn.gantt=function(e){var r=["hours","days","weeks","months"],T={source:[],holidays:[],itemsPerPage:7,dow:["S","M","T","W","T","F","S"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],waitText:"Please wait...",navigate:"buttons",scrollToToday:!0,useCookie:!1,cookieKey:"jquery.fn.gantt",scale:"days",maxScale:"months",minScale:"hours",draggable:!1,resize:!1,onItemClick:function(e){},onAddClick:function(e,t){},onDragEnd:function(e,t,a){},onResizeEnd:function(e,t,a){},onRender:O.noop};O.extend(T,e),T.useCookie=T.useCookie&&O.isFunction(O.cookie);var N={elementFromPoint:"CSS1Compat"===document.compatMode?function(e,t){return e-=window.pageXOffset,t-=window.pageYOffset,document.elementFromPoint(e,t)}:function(e,t){return e-=O(document).scrollLeft(),t-=O(document).scrollTop(),document.elementFromPoint(e,t)},create:function(t){"string"!=typeof T.source?(t.data=T.source,N.init(t)):O.getJSON(T.source,function(e){t.data=e,N.init(t)})},init:function(e){e.rowsNum=e.data.length,e.pageCount=Math.ceil(e.rowsNum/T.itemsPerPage),e.rowsOnLastPage=e.rowsNum-Math.floor(e.rowsNum/T.itemsPerPage)*T.itemsPerPage,e.dateStart=I.getMinDate(e),e.dateEnd=I.getMaxDate(e),N.waitToggle(e,function(){N.render(e)})},render:function(e){var t=O('<div class="fn-content"/>'),a=N.leftPanel(e);t.append(a);var n,s=N.rightPanel(e,a);t.append(s),t.append(N.navigation(e));var i=s.find(".dataPanel"),l=O('<div class="dataPanelData"/>');if(e.gantt=O('<div class="fn-gantt" />').append(t),O(e).empty().append(e.gantt),e.scrollNavigation.panelMargin=parseInt(i.css("left").replace("px",""),10),e.scrollNavigation.panelMaxPos=i.width()-s.width(),e.scrollNavigation.canScroll=i.width()>s.width(),N.markNow(e),N.fillData(e,i,a,l),T.useCookie){var o=O.cookie(T.cookieKey+"ScrollPos");o&&(e.hPosition=o)}T.scrollToToday?(N.navigateTo(e,"now"),N.scrollPanel(e,0)):(0!==e.hPosition&&(e.scaleOldWidth&&(n=(i.width()-s.width())*e.hPosition/e.scaleOldWidth,e.hPosition=0<n?0:n,e.scaleOldWidth=null),i.css({left:e.hPosition}),e.scrollNavigation.panelMargin=e.hPosition),N.repositionLabel(e)),i.css({height:a.height()}),N.waitToggle(e),T.onRender(),O.each(l.find(".bar"),function(){T.draggable&&I.makeBarDraggable(O(this)),T.resize&&I.makeBarResizable(O(this))})},leftPanel:function(n){var e=O('<div class="leftPanel"/>').append(O('<div class="row spacer"/>').css("height",I.getCellSize()*n.headerRows)),s=[];return O.each(n.data,function(e,t){if(e>=n.pageNum*T.itemsPerPage&&e<n.pageNum*T.itemsPerPage+T.itemsPerPage){var a="id"in t?'" data-id="'+t.id:"";s.push('<div class="row name row'+e+(t.desc?"":" fn-wide "+a)+'" id="rowheader'+e+'" data-offset="'+e%T.itemsPerPage*I.getCellSize()+'"><span class="fn-label'+(t.cssClass?" "+t.cssClass:"")+'">'+(t.name||"")+"</span></div>"),t.desc&&s.push('<div class="row desc row'+e+' " id="RowdId_'+e+a+'"><span class="fn-label'+(t.cssClass?" "+t.cssClass:"")+'">'+t.desc+"</span></div>")}}),e.append(s.join(""))},dataPanel:function(r,e){var t=O('<div class="dataPanel" style="width: '+e+'px;"/>'),a="onwheel"in r?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll";return O(r).on(a,function(e){N.wheelScroll(r,e)}),t.click(function(e){var t;e.stopPropagation();var a=O(r).find(".fn-gantt .leftPanel"),n=O(r).find(".fn-gantt .dataPanel");switch(T.scale){case"months":t=I.getCellSize();break;case"hours":t=4*I.getCellSize();break;case"days":t=3*I.getCellSize();break;case"weeks":default:t=2*I.getCellSize()}var s=N.elementFromPoint(e.pageX,n.offset().top+t),i=(s="fn-label"===s.className?O(s.parentNode):O(s)).data("repdate"),l=N.elementFromPoint(a.offset().left+a.width()-10,e.pageY),o=(l=0===l.className.indexOf("fn-label")?O(l.parentNode):O(l)).data("id");T.onAddClick(i,o)}),t},rightPanel:function(e,t){var a=null,n=["sn","wd","wd","wd","wd","wd","sa"],s=[],i=0,l=[],o=0,r=[],d=0,c=[],g=[],u=new Date;u.setHours(0,0,0,0);var h,f,p,v,w,m,y,b,D,k,S=O('<div class="row header"></div>');switch(T.scale){case"hours":for(k=(a=I.parseTimeRange(e.dateStart,e.dateEnd,e.scaleStep)).length*I.getCellSize(),p=a[0].getFullYear(),v=a[0].getMonth(),m=a[0],h=0,f=a.length;h<f;h++){var P=(y=a[h]).getFullYear();P!==p&&(s.push('<div class="row year" style="width: '+I.getCellSize()*i+'px;"><div class="fn-label">'+p+"</div></div>"),p=P,i=0),i++;var C=y.getMonth();C!==v&&(l.push('<div class="row month" style="width: '+I.getCellSize()*o+'px"><div class="fn-label">'+T.months[v]+"</div></div>"),v=C,o=0),o++;var z=y.getDay(),M=m.getDay();z!==M&&(b=u-m==0?"today":I.isHoliday(m.getTime())?"holiday":n[M],r.push('<div class="row date '+b+'" style="width: '+I.getCellSize()*d+'px;"><div class="fn-label">'+m.getDate()+"</div></div>"),c.push('<div class="row day '+b+'" style="width: '+I.getCellSize()*d+'px;"><div class="fn-label">'+T.dow[M]+"</div></div>"),m=y,d=0),d++,b=n[z],I.isHoliday(y)&&(b="holiday"),g.push('<div class="row day '+b+'" id="dh-'+y.getTime()+'" data-offset="'+h*I.getCellSize()+'" data-repdate="'+y.getRepDate(T.scale)+'"><div class="fn-label">'+y.getHours()+"</div></div>")}s.push('<div class="row year" style="width: '+I.getCellSize()*i+'px;"><div class="fn-label">'+p+"</div></div>"),l.push('<div class="row month" style="width: '+I.getCellSize()*o+'px"><div class="fn-label">'+T.months[v]+"</div></div>"),b=n[m.getDay()],I.isHoliday(m)&&(b="holiday"),r.push('<div class="row date '+b+'" style="width: '+I.getCellSize()*d+'px;"><div class="fn-label">'+m.getDate()+"</div></div>"),c.push('<div class="row day '+b+'" style="width: '+I.getCellSize()*d+'px;"><div class="fn-label">'+T.dow[m.getDay()]+"</div></div>"),(D=N.dataPanel(e,k)).append(S.clone().html(s.join("")),S.clone().html(l.join("")),S.clone().html(r.join("")),S.clone().html(c.join("")),S.clone().html(g.join("")));break;case"weeks":var x;for(k=(a=I.parseWeeksRange(e.dateStart,e.dateEnd)).length*I.getCellSize(),p=a[0].getFullYear(),v=a[0].getMonth(),w=a[0].getWeekOfYear(),h=0,f=a.length;h<f;h++)w>(w=(y=a[h]).getWeekOfYear())&&(x=y.getDate()-1,x-=y.getMonth()?31:0,x/=7,s.push('<div class="row year" style="width: '+I.getCellSize()*(i-x)+'px;"><div class="fn-label">'+p+"</div></div>"),p++,i=x),i++,y.getMonth()!==v&&(x=y.getDate()-1,x/=7,l.push('<div class="row month" style="width:'+I.getCellSize()*(o-x)+'px;"><div class="fn-label">'+T.months[v]+"</div></div>"),v=y.getMonth(),o=x),o++,r.push('<div class="row day wd" id="'+y.getWeekId()+'" data-offset="'+h*I.getCellSize()+'" data-repdate="'+y.getRepDate(T.scale)+'"><div class="fn-label">'+w+"</div></div>");s.push('<div class="row year" style="width: '+I.getCellSize()*i+'px;"><div class="fn-label">'+p+"</div></div>"),l.push('<div class="row month" style="width: '+I.getCellSize()*o+'px"><div class="fn-label">'+T.months[v]+"</div></div>"),(D=N.dataPanel(e,k)).append(S.clone().html(s.join("")),S.clone().html(l.join("")),S.clone().html(r.join("")));break;case"months":for(k=(a=I.parseMonthsRange(e.dateStart,e.dateEnd)).length*I.getCellSize(),p=a[0].getFullYear(),v=a[0].getMonth(),h=0,f=a.length;h<f;h++)(y=a[h]).getFullYear()!==p&&(s.push('<div class="row year" style="width: '+I.getCellSize()*i+'px;"><div class="fn-label">'+p+"</div></div>"),p=y.getFullYear(),i=0),i++,l.push('<div class="row day wd" id="dh-'+I.genId(y)+'" data-offset="'+h*I.getCellSize()+'" data-repdate="'+y.getRepDate(T.scale)+'">'+(1+y.getMonth())+"</div>");s.push('<div class="row year" style="width: '+I.getCellSize()*i+'px;"><div class="fn-label">'+p+"</div></div>"),(D=N.dataPanel(e,k)).append(S.clone().html(s.join("")),S.clone().html(l.join("")));break;default:for(k=(a=I.parseDateRange(e.dateStart,e.dateEnd)).length*I.getCellSize(),p=a[0].getFullYear(),v=a[0].getMonth(),h=0,f=a.length;h<f;h++)(y=a[h]).getFullYear()!==p&&(s.push('<div class="row year" style="width:'+I.getCellSize()*i+'px;"><div class="fn-label">'+p+"</div></div>"),p=y.getFullYear(),i=0),i++,y.getMonth()!==v&&(l.push('<div class="row month" style="width:'+I.getCellSize()*o+'px;"><div class="fn-label">'+T.months[v]+"</div></div>"),v=y.getMonth(),o=0),o++,b=n[m=y.getDay()],I.isHoliday(y)&&(b="holiday"),r.push('<div class="row date '+b+'" id="dh-'+I.genId(y)+'" data-offset="'+h*I.getCellSize()+'" data-repdate="'+y.getRepDate(T.scale)+'"><div class="fn-label">'+y.getDate()+"</div></div>"),c.push('<div class="row day '+b+'" id="dw-'+I.genId(y)+'" data-repdate="'+y.getRepDate(T.scale)+'"><div class="fn-label">'+T.dow[m]+"</div></div>");s.push('<div class="row year" style="width: '+I.getCellSize()*i+'px;"><div class="fn-label">'+p+"</div></div>"),l.push('<div class="row month" style="width: '+I.getCellSize()*o+'px"><div class="fn-label">'+T.months[v]+"</div></div>"),(D=N.dataPanel(e,k)).append(S.clone().html(s.join("")),S.clone().html(l.join("")),S.clone().html(r.join("")),S.clone().html(c.join("")))}return O('<div class="rightPanel"></div>').append(D)},navigation:function(t){var e=null;return"scroll"===T.navigate?(e=O('<div class="navigate" />').append(O('<div class="nav-slider" />').append(O('<div class="nav-slider-left" />').append(O('<button type="button" class="nav-link nav-page-back"/>').html("&uarr;").click(function(){N.navigatePage(t,-1)})).append(O('<div class="page-number"/>').append(O("<span/>").html(t.pageNum+1+" / "+t.pageCount))).append(O('<button type="button" class="nav-link nav-page-next"/>').html("&darr;").click(function(){N.navigatePage(t,1)})).append(O('<button type="button" class="nav-link nav-now"/>').html("&#9679;").click(function(){N.navigateTo(t,"now")})).append(O('<button type="button" class="nav-link nav-prev-week"/>').html("&lt;&lt;").click(function(){"hours"===T.scale?N.navigateTo(t,8*I.getCellSize()):"days"===T.scale?N.navigateTo(t,30*I.getCellSize()):"weeks"===T.scale?N.navigateTo(t,12*I.getCellSize()):"months"===T.scale&&N.navigateTo(t,6*I.getCellSize())})).append(O('<button type="button" class="nav-link nav-prev-day"/>').html("&lt;").click(function(){"hours"===T.scale?N.navigateTo(t,4*I.getCellSize()):"days"===T.scale?N.navigateTo(t,7*I.getCellSize()):"weeks"===T.scale?N.navigateTo(t,4*I.getCellSize()):"months"===T.scale&&N.navigateTo(t,3*I.getCellSize())}))).append(O('<div class="nav-slider-content" />').append(O('<div class="nav-slider-bar" />').append(O('<a class="nav-slider-button" />')).mousedown(function(e){e.preventDefault(),t.scrollNavigation.scrollerMouseDown=!0,N.sliderScroll(t,e)}).mousemove(function(e){t.scrollNavigation.scrollerMouseDown&&N.sliderScroll(t,e)}))).append(O('<div class="nav-slider-right" />').append(O('<button type="button" class="nav-link nav-next-day"/>').html("&gt;").click(function(){"hours"===T.scale?N.navigateTo(t,-4*I.getCellSize()):"days"===T.scale?N.navigateTo(t,-7*I.getCellSize()):"weeks"===T.scale?N.navigateTo(t,-4*I.getCellSize()):"months"===T.scale&&N.navigateTo(t,-3*I.getCellSize())})).append(O('<button type="button" class="nav-link nav-next-week"/>').html("&gt;&gt;").click(function(){"hours"===T.scale?N.navigateTo(t,-8*I.getCellSize()):"days"===T.scale?N.navigateTo(t,-30*I.getCellSize()):"weeks"===T.scale?N.navigateTo(t,-12*I.getCellSize()):"months"===T.scale&&N.navigateTo(t,-6*I.getCellSize())})).append(O('<button type="button" class="nav-link nav-zoomIn"/>').html("&#43;").click(function(){N.zoomInOut(t,-1)})).append(O('<button type="button" class="nav-link nav-zoomOut"/>').html("&#45;").click(function(){N.zoomInOut(t,1)})))),O(document).mouseup(function(){t.scrollNavigation.scrollerMouseDown=!1})):e=O('<div class="navigate" />').append(O('<button type="button" class="nav-link nav-page-back"/>').html("&uarr;").click(function(){N.navigatePage(t,-1)})).append(O('<div class="page-number"/>').append(O("<span/>").html(t.pageNum+1+" / "+t.pageCount))).append(O('<button type="button" class="nav-link nav-page-next"/>').html("&darr;").click(function(){N.navigatePage(t,1)})).append(O('<button type="button" class="nav-link nav-begin"/>').html("&#124;&lt;").click(function(){N.navigateTo(t,"begin")})).append(O('<button type="button" class="nav-link nav-prev-week"/>').html("&lt;&lt;").click(function(){N.navigateTo(t,7*I.getCellSize())})).append(O('<button type="button" class="nav-link nav-prev-day"/>').html("&lt;").click(function(){N.navigateTo(t,I.getCellSize())})).append(O('<button type="button" class="nav-link nav-now"/>').html("&#9679;").click(function(){N.navigateTo(t,"now")})).append(O('<button type="button" class="nav-link nav-next-day"/>').html("&gt;").click(function(){N.navigateTo(t,-1*I.getCellSize())})).append(O('<button type="button" class="nav-link nav-next-week"/>').html("&gt;&gt;").click(function(){N.navigateTo(t,-7*I.getCellSize())})).append(O('<button type="button" class="nav-link nav-end"/>').html("&gt;&#124;").click(function(){N.navigateTo(t,"end")})).append(O('<button type="button" class="nav-link nav-zoomIn"/>').html("&#43;").click(function(){N.zoomInOut(t,-1)})).append(O('<button type="button" class="nav-link nav-zoomOut"/>').html("&#45;").click(function(){N.zoomInOut(t,1)})),O('<div class="bottom"></div>').append(e)},createProgressBar:function(e,a,t,n){var s=O('<div class="bar"><div class="fn-label">'+(e=e||"")+"</div></div>").data("dataObj",n);return a&&s.mouseenter(function(e){var t=O('<div class="fn-gantt-hint" />').html(a);O("body").append(t),t.css("left",e.pageX),t.css("top",e.pageY),t.show()}).mouseleave(function(){O(".fn-gantt-hint").remove()}).mousemove(function(e){O(".fn-gantt-hint").css("left",e.pageX),O(".fn-gantt-hint").css("top",e.pageY+15)}),t&&s.addClass(t),s.click(function(e){e.stopPropagation(),T.onItemClick(O(this).data("dataObj"))}),s},markNow:function(e){var t=(new Date).setHours(0,0,0,0);switch(T.scale){case"weeks":O(e).find(':findweek("'+t+'")').removeClass("wd").addClass("today");break;case"months":O(e).find(':findmonth("'+t+'")').removeClass("wd").addClass("today");break;case"days":case"hours":default:O(e).find(':findday("'+t+'")').removeClass("wd").addClass("today")}},fillData:function(v,e,t,w){var m=I.getCellSize(),y=(m-18)/2,b=e.width();e.append(w);O.each(v.data,function(p,e){p>=v.pageNum*T.itemsPerPage&&p<v.pageNum*T.itemsPerPage+T.itemsPerPage&&O.each(e.values,function(e,t){var a,n,s,i,l,o,r,d,c,g,u;switch(T.scale){case"hours":o=I.genId(I.dateDeserialize(t.from),v.scaleStep),n=O(v).find("#dh-"+o),r=I.genId(I.dateDeserialize(t.to),v.scaleStep),s=O(v).find("#dh-"+r),i=n.data("offset"),l=s.data("offset"),d=Math.floor((l-i)/m)+1,c=100*(m*d-1)/b,a=N.createProgressBar(t.label,t.desc,t.customClass,t.dataObj),g=O(v).find("#rowheader"+p),u=5*m+y+g.data("offset"),a.css({top:u,left:Math.floor(i),width:c+"%"}),w.append(a);break;case"weeks":o=I.dateDeserialize(t.from),r=I.dateDeserialize(t.to),i=(n=O(v).find("#"+o.getWeekId())).data("offset"),l=(s=O(v).find("#"+r.getWeekId())).data("offset"),d=Math.round((l-i)/m)+1,c=100*(m*d-1)/b,a=N.createProgressBar(t.label,t.desc,t.customClass,t.dataObj),g=O(v).find("#rowheader"+p),u=3*m+y+g.data("offset"),a.css({top:u,left:Math.floor(i),width:c+"%"}),w.append(a);break;case"months":o=I.dateDeserialize(t.from),r=I.dateDeserialize(t.to),o.getDate()<=3&&0===o.getMonth()&&o.setDate(o.getDate()+4),o.getDate()<=3&&0===o.getMonth()&&o.setDate(o.getDate()+4),r.getDate()<=3&&0===r.getMonth()&&r.setDate(r.getDate()+4),i=(n=O(v).find("#dh-"+I.genId(o))).data("offset"),l=(s=O(v).find("#dh-"+I.genId(r))).data("offset"),d=Math.round((l-i)/m)+1,c=100*(m*d-1)/b,a=N.createProgressBar(t.label,t.desc,t.customClass,t.dataObj),g=O(v).find("#rowheader"+p),u=2*m+y+g.data("offset"),a.css({top:u,left:Math.floor(i),width:c+"%"}),w.append(a);break;case"days":default:o=I.genId(I.dateDeserialize(t.from)),r=I.genId(I.dateDeserialize(t.to)),i=(n=O(v).find("#dh-"+o)).data("offset"),d=Math.round((r-o)/864e5)+1,c=100*(m*d-1)/b,a=N.createProgressBar(t.label,t.desc,t.customClass,t.dataObj),g=O(v).find("#rowheader"+p),u=4*m+y+g.data("offset"),a.css({top:u,left:Math.floor(i),width:c+"%"}),w.append(a)}var h=a.find(".fn-label");if(h.length){var f=function(e){try{var t=(e=e.replace("rgb(","").replace(")","")).split(","),a=parseInt(t[0],10),n=parseInt(t[1],10),s=parseInt(t[2],10),i=Math.round(.9*(255-(.299*a+.587*n+.114*s)));return"rgb("+i+", "+i+", "+i+")"}catch(e){return""}}(a.css("backgroundColor"));h.css("color",f)}})});var a=0;O.each(O(".row.header"),function(){a+=this.clientHeight}),w.css({float:"left",height:"calc(100% - "+a+"px)",width:"100%"})},navigateTo:function(e,t){function a(){N.repositionLabel(e)}var n,s,i=O(e).find(".fn-gantt .rightPanel"),l=i.find(".dataPanel"),o=i.width(),r=l.width();switch(t){case"begin":l.animate({left:"0"},"fast",a),e.scrollNavigation.panelMargin=0;break;case"end":var d=r-o;e.scrollNavigation.panelMargin=-1*d,l.animate({left:"-"+d},"fast",a);break;case"now":if(!e.scrollNavigation.canScroll||!l.find(".today").length)return!1;n=-1*(r-o),s=l.css("left").replace("px",""),t=l.find(".today").offset().left-l.offset().left,0<(t*=-1)?t=0:t<n&&(t=n),l.animate({left:t},"fast",a),e.scrollNavigation.panelMargin=t;break;default:n=-1*(r-o),s=l.css("left").replace("px",""),(t=parseInt(s,10)+t)<=0&&n<=t&&l.animate({left:t},"fast",a),e.scrollNavigation.panelMargin=t}N.synchronizeScroller(e)},navigatePage:function(e,t){0<=e.pageNum+t&&e.pageNum+t<Math.ceil(e.rowsNum/T.itemsPerPage)&&N.waitToggle(e,function(){e.pageNum+=t,e.hPosition=O(".fn-gantt .dataPanel").css("left").replace("px",""),e.scaleOldWidth=!1,N.init(e)})},zoomInOut:function(l,o){N.waitToggle(l,function(){var e=o<0,t=l.scaleStep+3*o;t={4:3,5:6,9:8,11:12}[t]||(t<1?1:t);var a=T.scale,n=l.headerRows;if("hours"===T.scale&&13<=t?(a="days",n=4,t=13):"days"===T.scale&&e?(a="hours",n=5,t=12):"days"!==T.scale||e?"weeks"!==T.scale||e?"weeks"===T.scale&&e?(a="days",n=4,t=13):"months"===T.scale&&e&&(a="weeks",n=3,t=13):(a="months",n=2,t=14):(a="weeks",n=3,t=13),e&&O.inArray(a,r)<O.inArray(T.minScale,r)||!e&&O.inArray(a,r)>O.inArray(T.maxScale,r))N.init(l);else{l.scaleStep=t,T.scale=a,l.headerRows=n;var s=O(l).find(".fn-gantt .rightPanel"),i=s.find(".dataPanel");l.hPosition=i.css("left").replace("px",""),l.scaleOldWidth=i.width()-s.width(),T.useCookie&&(O.cookie(T.cookieKey+"CurrentScale",T.scale),O.cookie(T.cookieKey+"ScrollPos",null)),N.init(l)}})},mouseScroll:function(e,t){var a=O(e).find(".fn-gantt .dataPanel");a.css("cursor","move");a.offset();var n=null===e.scrollNavigation.mouseX?t.pageX:e.scrollNavigation.mouseX,s=t.pageX-n;e.scrollNavigation.mouseX=t.pageX,N.scrollPanel(e,s),clearTimeout(e.scrollNavigation.repositionDelay),e.scrollNavigation.repositionDelay=setTimeout(N.repositionLabel,50,e)},wheelScroll:function(e,t){t.preventDefault();var a="detail"in t?t.detail:"wheelDelta"in t.originalEvent?-1/120*t.originalEvent.wheelDelta:t.originalEvent.deltaY?t.originalEvent.deltaY/Math.abs(t.originalEvent.deltaY):t.originalEvent.detail;N.scrollPanel(e,-50*a),clearTimeout(e.scrollNavigation.repositionDelay),e.scrollNavigation.repositionDelay=setTimeout(N.repositionLabel,50,e)},sliderScroll:function(e,t){var a,n,s=O(e).find(".nav-slider-bar"),i=s.find(".nav-slider-button"),l=O(e).find(".fn-gantt .rightPanel"),o=l.find(".dataPanel"),r=s.offset(),d=s.width(),c=i.width();if(t.pageX>=r.left&&t.pageX<=r.left+d){a=t.pageX-r.left,a-=c/2,i.css("left",a);var g=a*(n=o.width()-l.width())/d*-1;0<=g?(o.css("left","0"),e.scrollNavigation.panelMargin=0):d-1*c<=a?(o.css("left",-1*n),e.scrollNavigation.panelMargin=-1*n):(o.css("left",g),e.scrollNavigation.panelMargin=g),clearTimeout(e.scrollNavigation.repositionDelay),e.scrollNavigation.repositionDelay=setTimeout(N.repositionLabel,5,e)}},scrollPanel:function(e,t){if(!e.scrollNavigation.canScroll)return!1;var a=parseInt(e.scrollNavigation.panelMargin,10)+t;0<a?e.scrollNavigation.panelMargin=0:a<-1*e.scrollNavigation.panelMaxPos?e.scrollNavigation.panelMargin=-1*e.scrollNavigation.panelMaxPos:e.scrollNavigation.panelMargin=a,O(e).find(".fn-gantt .dataPanel").css("left",e.scrollNavigation.panelMargin),N.synchronizeScroller(e)},synchronizeScroller:function(e){if("scroll"===T.navigate){var t=O(e).find(".fn-gantt .rightPanel"),a=t.find(".dataPanel"),n=O(e).find(".nav-slider-bar"),s=n.find(".nav-slider-button"),i=n.width(),l=s.width(),o=a.width()-t.width(),r=a.css("left")||0,d=(r=r&&r.replace("px",""))*i/o-.25*s.width();d=0<d?0:i-.75*l<=-1*d?-1*(i-1.25*l):d,s.css("left",-1*d)}},repositionLabel:function(t){setTimeout(function(){var e;t?e=O(t).find(".fn-gantt .rightPanel").find(".dataPanel"):e=O(".fn-gantt .rightPanel .dataPanel");T.useCookie&&O.cookie(T.cookieKey+"ScrollPos",e.css("left").replace("px",""))},500)},waitToggle:function(e,t){if(O.isFunction(t)){var a=O(e);a.offset(),a.outerWidth(),a.outerHeight();e.loader||(e.loader=O('<div class="fn-gantt-loader"><div class="fn-gantt-loader-spinner"><span>'+T.waitText+"</span></div></div>")),a.append(e.loader),setTimeout(t,500)}else e.loader&&e.loader.detach()}},I={getMaxDate:function(e){var t,a=null;switch(O.each(e.data,function(e,t){O.each(t.values,function(e,t){a=a<I.dateDeserialize(t.to)?I.dateDeserialize(t.to):a})}),a=a||new Date,T.scale){case"hours":a.setHours(Math.ceil(a.getHours()/e.scaleStep)*e.scaleStep),a.setHours(a.getHours()+3*e.scaleStep);break;case"weeks":t=new Date(a.getTime()),t=new Date(t.setDate(t.getDate()+21));var n=7*Math.floor(t.getDate()/7);a=new Date(t.getFullYear(),t.getMonth(),0==n?4:n-3);break;case"months":(t=new Date(a.getFullYear(),a.getMonth(),1)).setMonth(t.getMonth()+2),a=new Date(t.getFullYear(),t.getMonth(),1);break;case"days":default:a.setHours(0),a.setDate(a.getDate()+3)}return a},getMinDate:function(e){var a=null;switch(O.each(e.data,function(e,t){O.each(t.values,function(e,t){a=a>I.dateDeserialize(t.from)||null===a?I.dateDeserialize(t.from):a})}),a=a||new Date,T.scale){case"hours":a.setHours(Math.floor(a.getHours()/e.scaleStep)*e.scaleStep),a.setHours(a.getHours()-3*e.scaleStep);break;case"weeks":var t=new Date(a.getTime());t=new Date(t.setDate(t.getDate()-21));var n=7*Math.floor(t.getDate()/7);a=new Date(t.getFullYear(),t.getMonth(),0==n?4:n-3);break;case"months":a.setHours(0,0,0,0),a.setDate(1),a.setMonth(a.getMonth()-3);break;case"days":default:a.setHours(0,0,0,0),a.setDate(a.getDate()-3)}return a},parseDateRange:function(e,t){for(var a=e.getFullYear(),n=e.getMonth(),s=e.getDate(),i=[],l=0;i[l]=new Date(a,n,s+l),i[l++]<t;);return i},parseTimeRange:function(e,t,a){var n=e.getFullYear(),s=e.getMonth(),i=e.getDate(),l=e.getHours();l-=l%a;for(var o=[],r=0,d=0;o[d]=new Date(n,s,i,l+r++*a),0<d&&o[d].getHours()===o[d-1].getHours()&&d--,o[d++]<t;);return o},parseWeeksRange:function(e,t){for(var a=e.getDayForWeek(),n=[],s=0;n[s++]=a.getDayForWeek(),a.setDate(a.getDate()+7),a<=t;);return n},parseMonthsRange:function(e,t){for(var a=new Date(e),n=(new Date(t),[]),s=0;n[s++]=new Date(a.getFullYear(),a.getMonth(),1),a.setMonth(a.getMonth()+1),a<=t;);return n},dateDeserialize:function(e){return"string"==typeof e&&(e=e.replace(/\/Date\((.*)\)\//,"$1"),e=O.isNumeric(e)?parseInt(e,10):O.trim(e)),new Date(e)},makeBarDraggable:function(e){e.draggable({containment:"parent",start:function(e,t){O(this).data("startx",O(this).css("left").split("px")[0]),O(this).data("starty",O(this).css("top").split("px")[0])},stop:function(e,t){parseInt(O(this).css("left").split("px")[0]),parseInt(O(this).data("startx"));var a=parseInt(O(this).css("top").split("px")[0]);a-=a%24,a+=3,O(this).css("top",a);parseInt(O(this).data("starty"));var n=I.getNearOffset(parseInt(O(this).css("left")));O(this).css("left",n+"px");var s=I.getNearOffset(parseInt(O(this).css("left"))+parseInt(O(this).css("width")));O(this).css("width",s-parseInt(O(this).css("left"))+"px");var i=I.getBarDates(O(this));T.onDragEnd(O(this),I.dateDeserialize(i.from),I.dateDeserialize(i.to))}})},makeBarResizable:function(e){e.resizable({handles:"e, w",stop:function(e,t){if(t.originalPosition.left!=t.position.left){var a=I.getNearOffset(parseInt(O(this).css("left")));O(this).css("left",a+"px")}if(t.originalSize.width!=t.size.width){var n=I.getNearOffset(parseInt(O(this).css("left"))+parseInt(O(this).css("width")));O(this).css("width",n-parseInt(O(this).css("left"))+"px")}var s=I.getBarDates(O(this));T.onResizeEnd(O(this),I.dateDeserialize(s.from),I.dateDeserialize(s.to))}})},getNearOffset:function(a){return O.map(O(".row.day[data-offset]"),function(e){return e.dataset.offset}).reduce(function(e,t){return Math.abs(t-a)<Math.abs(e-a)?t:e})},getBarDates:function(e){var t=parseInt(e.css("left")),a=t+parseInt(e.css("width"));return{from:O('.row.day[data-offset="'+t+'"]').data("repdate"),to:O('.row.day[data-offset="'+a+'"]').data("repdate")}},genId:function(e){switch(O.isNumeric(e)&&(e=new Date(e)),T.scale){case"hours":var t=e.getHours();return 2<=arguments.length&&(t=Math.floor(e.getHours()/arguments[1])*arguments[1]),new Date(e.getFullYear(),e.getMonth(),e.getDate(),t).getTime();case"weeks":var a=e.getFullYear(),n=e.getWeekOfYear(),s=e.getMonth();return 11===s&&1===n?a++:!s&&51<n&&a--,a+"-"+n;case"months":return e.getFullYear()+"-"+e.getMonth();case"days":default:return new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime()}},_datesToDays:function(e){for(var t={},a=0,n=e.length;a<n;a++)t[I.dateDeserialize(e[a]).setHours(0,0,0,0)]=!0;return t},isHoliday:function(){if(!T.holidays||!T.holidays.length)return function(){return!1};var t=!1;return function(e){return!!(t=t||I._datesToDays(T.holidays))[O.isNumeric(e)?e:new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime()]}}(),getCellSize:function(){if(void 0===I._getCellSize){var e=O('<div style="display: none; position: absolute;" class="fn-gantt"><div class="row"></div></div>');O("body").append(e),I._getCellSize=e.find(".row").height(),e.empty().remove()}return I._getCellSize},getPageHeight:function(e){return e.pageNum+1===e.pageCount?e.rowsOnLastPage*I.getCellSize():T.itemsPerPage*I.getCellSize()}};this.each(function(){if(this.data=null,this.pageNum=0,this.pageCount=0,this.rowsOnLastPage=0,this.rowsNum=0,this.hPosition=0,this.dateStart=null,this.dateEnd=null,this.scrollClicked=!1,this.scaleOldWidth=null,this.headerRows=null,T.useCookie){var e=O.cookie(T.cookieKey+"CurrentScale");e?T.scale=e:O.cookie(T.cookieKey+"CurrentScale",T.scale)}switch(T.scale){case"hours":this.headerRows=5,this.scaleStep=1;break;case"weeks":this.headerRows=3,this.scaleStep=13;break;case"months":this.headerRows=2,this.scaleStep=14;break;case"days":default:this.headerRows=4,this.scaleStep=13}this.scrollNavigation={panelMouseDown:!1,scrollerMouseDown:!1,mouseX:null,panelMargin:0,repositionDelay:0,panelMaxPos:0,canScroll:!0},this.gantt=null,this.loader=null,N.create(this)})}}($);