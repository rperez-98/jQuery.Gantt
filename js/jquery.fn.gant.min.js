!function(F){"use strict";function n(e,t){var a=new Date(parseInt(t,10));a.setHours(0,0,0,0);var n=F(e).attr("id")||"",l=n.indexOf("-")+1,s=new Date(parseInt(n.substring(l,n.length),10));return s.setHours(0,0,0,0),a.getTime()===s.getTime()}function l(e,t){var a=new Date(parseInt(t,10)),n=a.getFullYear(),l=a.getWeekOfYear(),s=a.getMonth();11===s&&1===l?n++:!s&&51<l&&n--,a=n+"-"+l;var i=F(e).attr("id")||"",o=i.indexOf("-")+1;return a===i.substring(o,i.length)}function s(e,t){var a=new Date(parseInt(t,10));a=a.getFullYear()+"-"+a.getMonth();var n=F(e).attr("id")||"",l=n.indexOf("-")+1;return a===n.substring(l,n.length)}F.expr.pseudos.findday=F.expr.createPseudo?F.expr.createPseudo(function(t){return function(e){return n(e,t)}}):function(e,t,a){return n(e,a[3])},F.expr.pseudos.findweek=F.expr.createPseudo?F.expr.createPseudo(function(t){return function(e){return l(e,t)}}):function(e,t,a){return l(e,a[3])},F.expr[":"].findmonth=F.expr.createPseudo?F.expr.createPseudo(function(t){return function(e){return s(e,t)}}):function(e,t,a){return s(e,a[3])},Date.prototype.getWeekId=function(){var e=this.getFullYear(),t=this.getWeekOfYear(),a=this.getMonth();return 11===a&&1===t?e++:!a&&51<t&&e--,"dh-"+e+"-"+t},Date.prototype.getRepDate=function(e){switch(e){case"hours":return this.getTime();case"weeks":return this.getDayForWeek().getTime();case"months":return new Date(this.getFullYear(),this.getMonth(),1).getTime();case"days":default:return this.getTime()}},Date.prototype.getDayOfYear=function(){var e=this.getFullYear();return(Date.UTC(e,this.getMonth(),this.getDate())-Date.UTC(e,0,0))/864e5};Date.prototype.getWeekOfYear=function(){var e=this.getFullYear(),t=this.getMonth(),a=this.getDate(),n=this.getDay(),l=4-n;return n<1&&(l-=7),l+7<3&&(l+=7),Math.ceil(new Date(e,t,a+l).getDayOfYear()/7)},Date.prototype.getDayForWeek=function(){var e=this.getDay(),t=1+(e<1?-7:0)-e;return new Date(this.getFullYear(),this.getMonth(),this.getDate()+t)},F.fn.gantt=function(e){var r=["hours","days","weeks","months"],x={source:[],holidays:[],itemsPerPage:7,dow:["S","M","T","W","T","F","S"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],waitText:"Please wait...",navigate:"buttons",scrollToToday:!0,useCookie:!1,cookieKey:"jquery.fn.gantt",scale:"days",maxScale:"months",minScale:"hours",draggable:!1,resize:!1,onItemClick:function(e){},onAddClick:function(e,t){},onRender:F.noop};F.extend(x,e),x.useCookie=x.useCookie&&F.isFunction(F.cookie);var N={elementFromPoint:"CSS1Compat"===document.compatMode?function(e,t){return e-=window.pageXOffset,t-=window.pageYOffset,document.elementFromPoint(e,t)}:function(e,t){return e-=F(document).scrollLeft(),t-=F(document).scrollTop(),document.elementFromPoint(e,t)},create:function(t){"string"!=typeof x.source?(t.data=x.source,N.init(t)):F.getJSON(x.source,function(e){t.data=e,N.init(t)})},init:function(e){e.rowsNum=e.data.length,e.pageCount=Math.ceil(e.rowsNum/x.itemsPerPage),e.rowsOnLastPage=e.rowsNum-Math.floor(e.rowsNum/x.itemsPerPage)*x.itemsPerPage,e.dateStart=Y.getMinDate(e),e.dateEnd=Y.getMaxDate(e),N.waitToggle(e,function(){N.render(e)})},render:function(e){var t=F('<div class="fn-content"/>'),a=N.leftPanel(e);t.append(a);var n,l=N.rightPanel(e,a);t.append(l),t.append(N.navigation(e));var s=l.find(".dataPanel"),i=F('<div class="dataPanelData"/>');if(e.gantt=F('<div class="fn-gantt" />').append(t),F(e).empty().append(e.gantt),e.scrollNavigation.panelMargin=parseInt(s.css("left").replace("px",""),10),e.scrollNavigation.panelMaxPos=s.width()-l.width(),e.scrollNavigation.canScroll=s.width()>l.width(),N.markNow(e),N.fillData(e,s,a,i),x.useCookie){var o=F.cookie(x.cookieKey+"ScrollPos");o&&(e.hPosition=o)}x.scrollToToday?(N.navigateTo(e,"now"),N.scrollPanel(e,0)):(0!==e.hPosition&&(e.scaleOldWidth&&(n=(s.width()-l.width())*e.hPosition/e.scaleOldWidth,e.hPosition=0<n?0:n,e.scaleOldWidth=null),s.css({left:e.hPosition}),e.scrollNavigation.panelMargin=e.hPosition),N.repositionLabel(e)),s.css({height:a.height()}),N.waitToggle(e),x.onRender(),F.each(i.find(".bar"),function(){x.draggable&&Y.makeBarDraggable(F(this)),x.resize&&Y.makeBarResizable(F(this))})},leftPanel:function(n){var e=F('<div class="leftPanel"/>').append(F('<div class="row spacer"/>').css("height",Y.getCellSize()*n.headerRows)),l=[];return F.each(n.data,function(e,t){if(e>=n.pageNum*x.itemsPerPage&&e<n.pageNum*x.itemsPerPage+x.itemsPerPage){var a="id"in t?'" data-id="'+t.id:"";l.push('<div class="row name row'+e+(t.desc?"":" fn-wide "+a)+'" id="rowheader'+e+'" data-offset="'+e%x.itemsPerPage*Y.getCellSize()+'"><span class="fn-label'+(t.cssClass?" "+t.cssClass:"")+'">'+(t.name||"")+"</span></div>"),t.desc&&l.push('<div class="row desc row'+e+' " id="RowdId_'+e+a+'"><span class="fn-label'+(t.cssClass?" "+t.cssClass:"")+'">'+t.desc+"</span></div>")}}),e.append(l.join(""))},dataPanel:function(r,e){var t=F('<div class="dataPanel" style="width: '+e+'px;"/>'),a="onwheel"in r?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll";return F(r).on(a,function(e){N.wheelScroll(r,e)}),t.click(function(e){var t;e.stopPropagation();var a=F(r).find(".fn-gantt .leftPanel"),n=F(r).find(".fn-gantt .dataPanel");switch(x.scale){case"months":t=Y.getCellSize();break;case"hours":t=4*Y.getCellSize();break;case"days":t=3*Y.getCellSize();break;case"weeks":default:t=2*Y.getCellSize()}var l=N.elementFromPoint(e.pageX,n.offset().top+t),s=(l="fn-label"===l.className?F(l.parentNode):F(l)).data("repdate"),i=N.elementFromPoint(a.offset().left+a.width()-10,e.pageY),o=(i=0===i.className.indexOf("fn-label")?F(i.parentNode):F(i)).data("id");x.onAddClick(s,o)}),t},rightPanel:function(e,t){var a=null,n=["sn","wd","wd","wd","wd","wd","sa"],l=[],s=0,i=[],o=0,r=[],d=0,c=[],g=[],u=new Date;u.setHours(0,0,0,0);var h,p,f,v,w,m,y,b,k,D,S=F('<div class="row header"></div>');switch(x.scale){case"hours":for(D=(a=Y.parseTimeRange(e.dateStart,e.dateEnd,e.scaleStep)).length*Y.getCellSize(),f=a[0].getFullYear(),v=a[0].getMonth(),m=a[0],h=0,p=a.length;h<p;h++){var P=(y=a[h]).getFullYear();P!==f&&(l.push('<div class="row year" style="width: '+Y.getCellSize()*s+'px;"><div class="fn-label">'+f+"</div></div>"),f=P,s=0),s++;var C=y.getMonth();C!==v&&(i.push('<div class="row month" style="width: '+Y.getCellSize()*o+'px"><div class="fn-label">'+x.months[v]+"</div></div>"),v=C,o=0),o++;var M=y.getDay(),z=m.getDay();M!==z&&(b=u-m==0?"today":Y.isHoliday(m.getTime())?"holiday":n[z],r.push('<div class="row date '+b+'" style="width: '+Y.getCellSize()*d+'px;"><div class="fn-label">'+m.getDate()+"</div></div>"),c.push('<div class="row day '+b+'" style="width: '+Y.getCellSize()*d+'px;"><div class="fn-label">'+x.dow[z]+"</div></div>"),m=y,d=0),d++,b=n[M],Y.isHoliday(y)&&(b="holiday"),g.push('<div class="row day '+b+'" id="dh-'+y.getTime()+'" data-offset="'+h*Y.getCellSize()+'" data-repdate="'+y.getRepDate(x.scale)+'"><div class="fn-label">'+y.getHours()+"</div></div>")}l.push('<div class="row year" style="width: '+Y.getCellSize()*s+'px;"><div class="fn-label">'+f+"</div></div>"),i.push('<div class="row month" style="width: '+Y.getCellSize()*o+'px"><div class="fn-label">'+x.months[v]+"</div></div>"),b=n[m.getDay()],Y.isHoliday(m)&&(b="holiday"),r.push('<div class="row date '+b+'" style="width: '+Y.getCellSize()*d+'px;"><div class="fn-label">'+m.getDate()+"</div></div>"),c.push('<div class="row day '+b+'" style="width: '+Y.getCellSize()*d+'px;"><div class="fn-label">'+x.dow[m.getDay()]+"</div></div>"),(k=N.dataPanel(e,D)).append(S.clone().html(l.join("")),S.clone().html(i.join("")),S.clone().html(r.join("")),S.clone().html(c.join("")),S.clone().html(g.join("")));break;case"weeks":var T;for(D=(a=Y.parseWeeksRange(e.dateStart,e.dateEnd)).length*Y.getCellSize(),f=a[0].getFullYear(),v=a[0].getMonth(),w=a[0].getWeekOfYear(),h=0,p=a.length;h<p;h++)w>(w=(y=a[h]).getWeekOfYear())&&(T=y.getDate()-1,T-=y.getMonth()?31:0,T/=7,l.push('<div class="row year" style="width: '+Y.getCellSize()*(s-T)+'px;"><div class="fn-label">'+f+"</div></div>"),f++,s=T),s++,y.getMonth()!==v&&(T=y.getDate()-1,T/=7,i.push('<div class="row month" style="width:'+Y.getCellSize()*(o-T)+'px;"><div class="fn-label">'+x.months[v]+"</div></div>"),v=y.getMonth(),o=T),o++,r.push('<div class="row day wd" id="'+y.getWeekId()+'" data-offset="'+h*Y.getCellSize()+'" data-repdate="'+y.getRepDate(x.scale)+'"><div class="fn-label">'+w+"</div></div>");l.push('<div class="row year" style="width: '+Y.getCellSize()*s+'px;"><div class="fn-label">'+f+"</div></div>"),i.push('<div class="row month" style="width: '+Y.getCellSize()*o+'px"><div class="fn-label">'+x.months[v]+"</div></div>"),(k=N.dataPanel(e,D)).append(S.clone().html(l.join("")),S.clone().html(i.join("")),S.clone().html(r.join("")));break;case"months":for(D=(a=Y.parseMonthsRange(e.dateStart,e.dateEnd)).length*Y.getCellSize(),f=a[0].getFullYear(),v=a[0].getMonth(),h=0,p=a.length;h<p;h++)(y=a[h]).getFullYear()!==f&&(l.push('<div class="row year" style="width: '+Y.getCellSize()*s+'px;"><div class="fn-label">'+f+"</div></div>"),f=y.getFullYear(),s=0),s++,i.push('<div class="row day wd" id="dh-'+Y.genId(y)+'" data-offset="'+h*Y.getCellSize()+'" data-repdate="'+y.getRepDate(x.scale)+'">'+(1+y.getMonth())+"</div>");l.push('<div class="row year" style="width: '+Y.getCellSize()*s+'px;"><div class="fn-label">'+f+"</div></div>"),(k=N.dataPanel(e,D)).append(S.clone().html(l.join("")),S.clone().html(i.join("")));break;default:for(D=(a=Y.parseDateRange(e.dateStart,e.dateEnd)).length*Y.getCellSize(),f=a[0].getFullYear(),v=a[0].getMonth(),h=0,p=a.length;h<p;h++)(y=a[h]).getFullYear()!==f&&(l.push('<div class="row year" style="width:'+Y.getCellSize()*s+'px;"><div class="fn-label">'+f+"</div></div>"),f=y.getFullYear(),s=0),s++,y.getMonth()!==v&&(i.push('<div class="row month" style="width:'+Y.getCellSize()*o+'px;"><div class="fn-label">'+x.months[v]+"</div></div>"),v=y.getMonth(),o=0),o++,b=n[m=y.getDay()],Y.isHoliday(y)&&(b="holiday"),r.push('<div class="row date '+b+'" id="dh-'+Y.genId(y)+'" data-offset="'+h*Y.getCellSize()+'" data-repdate="'+y.getRepDate(x.scale)+'"><div class="fn-label">'+y.getDate()+"</div></div>"),c.push('<div class="row day '+b+'" id="dw-'+Y.genId(y)+'" data-repdate="'+y.getRepDate(x.scale)+'"><div class="fn-label">'+x.dow[m]+"</div></div>");l.push('<div class="row year" style="width: '+Y.getCellSize()*s+'px;"><div class="fn-label">'+f+"</div></div>"),i.push('<div class="row month" style="width: '+Y.getCellSize()*o+'px"><div class="fn-label">'+x.months[v]+"</div></div>"),(k=N.dataPanel(e,D)).append(S.clone().html(l.join("")),S.clone().html(i.join("")),S.clone().html(r.join("")),S.clone().html(c.join("")))}return F('<div class="rightPanel"></div>').append(k)},navigation:function(t){var e=null;return"scroll"===x.navigate?(e=F('<div class="navigate" />').append(F('<div class="nav-slider" />').append(F('<div class="nav-slider-left" />').append(F('<button type="button" class="nav-link nav-page-back"/>').html("&uarr;").click(function(){N.navigatePage(t,-1)})).append(F('<div class="page-number"/>').append(F("<span/>").html(t.pageNum+1+" / "+t.pageCount))).append(F('<button type="button" class="nav-link nav-page-next"/>').html("&darr;").click(function(){N.navigatePage(t,1)})).append(F('<button type="button" class="nav-link nav-now"/>').html("&#9679;").click(function(){N.navigateTo(t,"now")})).append(F('<button type="button" class="nav-link nav-prev-week"/>').html("&lt;&lt;").click(function(){"hours"===x.scale?N.navigateTo(t,8*Y.getCellSize()):"days"===x.scale?N.navigateTo(t,30*Y.getCellSize()):"weeks"===x.scale?N.navigateTo(t,12*Y.getCellSize()):"months"===x.scale&&N.navigateTo(t,6*Y.getCellSize())})).append(F('<button type="button" class="nav-link nav-prev-day"/>').html("&lt;").click(function(){"hours"===x.scale?N.navigateTo(t,4*Y.getCellSize()):"days"===x.scale?N.navigateTo(t,7*Y.getCellSize()):"weeks"===x.scale?N.navigateTo(t,4*Y.getCellSize()):"months"===x.scale&&N.navigateTo(t,3*Y.getCellSize())}))).append(F('<div class="nav-slider-content" />').append(F('<div class="nav-slider-bar" />').append(F('<a class="nav-slider-button" />')).mousedown(function(e){e.preventDefault(),t.scrollNavigation.scrollerMouseDown=!0,N.sliderScroll(t,e)}).mousemove(function(e){t.scrollNavigation.scrollerMouseDown&&N.sliderScroll(t,e)}))).append(F('<div class="nav-slider-right" />').append(F('<button type="button" class="nav-link nav-next-day"/>').html("&gt;").click(function(){"hours"===x.scale?N.navigateTo(t,-4*Y.getCellSize()):"days"===x.scale?N.navigateTo(t,-7*Y.getCellSize()):"weeks"===x.scale?N.navigateTo(t,-4*Y.getCellSize()):"months"===x.scale&&N.navigateTo(t,-3*Y.getCellSize())})).append(F('<button type="button" class="nav-link nav-next-week"/>').html("&gt;&gt;").click(function(){"hours"===x.scale?N.navigateTo(t,-8*Y.getCellSize()):"days"===x.scale?N.navigateTo(t,-30*Y.getCellSize()):"weeks"===x.scale?N.navigateTo(t,-12*Y.getCellSize()):"months"===x.scale&&N.navigateTo(t,-6*Y.getCellSize())})).append(F('<button type="button" class="nav-link nav-zoomIn"/>').html("&#43;").click(function(){N.zoomInOut(t,-1)})).append(F('<button type="button" class="nav-link nav-zoomOut"/>').html("&#45;").click(function(){N.zoomInOut(t,1)})))),F(document).mouseup(function(){t.scrollNavigation.scrollerMouseDown=!1})):e=F('<div class="navigate" />').append(F('<button type="button" class="nav-link nav-page-back"/>').html("&uarr;").click(function(){N.navigatePage(t,-1)})).append(F('<div class="page-number"/>').append(F("<span/>").html(t.pageNum+1+" / "+t.pageCount))).append(F('<button type="button" class="nav-link nav-page-next"/>').html("&darr;").click(function(){N.navigatePage(t,1)})).append(F('<button type="button" class="nav-link nav-begin"/>').html("&#124;&lt;").click(function(){N.navigateTo(t,"begin")})).append(F('<button type="button" class="nav-link nav-prev-week"/>').html("&lt;&lt;").click(function(){N.navigateTo(t,7*Y.getCellSize())})).append(F('<button type="button" class="nav-link nav-prev-day"/>').html("&lt;").click(function(){N.navigateTo(t,Y.getCellSize())})).append(F('<button type="button" class="nav-link nav-now"/>').html("&#9679;").click(function(){N.navigateTo(t,"now")})).append(F('<button type="button" class="nav-link nav-next-day"/>').html("&gt;").click(function(){N.navigateTo(t,-1*Y.getCellSize())})).append(F('<button type="button" class="nav-link nav-next-week"/>').html("&gt;&gt;").click(function(){N.navigateTo(t,-7*Y.getCellSize())})).append(F('<button type="button" class="nav-link nav-end"/>').html("&gt;&#124;").click(function(){N.navigateTo(t,"end")})).append(F('<button type="button" class="nav-link nav-zoomIn"/>').html("&#43;").click(function(){N.zoomInOut(t,-1)})).append(F('<button type="button" class="nav-link nav-zoomOut"/>').html("&#45;").click(function(){N.zoomInOut(t,1)})),F('<div class="bottom"></div>').append(e)},createProgressBar:function(e,a,t,n){var l=F('<div class="bar"><div class="fn-label">'+(e=e||"")+"</div></div>").data("dataObj",n);return a&&l.mouseenter(function(e){var t=F('<div class="fn-gantt-hint" />').html(a);F("body").append(t),t.css("left",e.pageX),t.css("top",e.pageY),t.show()}).mouseleave(function(){F(".fn-gantt-hint").remove()}).mousemove(function(e){F(".fn-gantt-hint").css("left",e.pageX),F(".fn-gantt-hint").css("top",e.pageY+15)}),t&&l.addClass(t),l.click(function(e){e.stopPropagation(),x.onItemClick(F(this).data("dataObj"))}),l},markNow:function(e){var t=(new Date).setHours(0,0,0,0);switch(x.scale){case"weeks":F(e).find(':findweek("'+t+'")').removeClass("wd").addClass("today");break;case"months":F(e).find(':findmonth("'+t+'")').removeClass("wd").addClass("today");break;case"days":case"hours":default:F(e).find(':findday("'+t+'")').removeClass("wd").addClass("today")}},fillData:function(v,e,t,w){var m=Y.getCellSize(),y=(m-18)/2,b=e.width();e.append(w);F.each(v.data,function(f,e){f>=v.pageNum*x.itemsPerPage&&f<v.pageNum*x.itemsPerPage+x.itemsPerPage&&F.each(e.values,function(e,t){var a,n,l,s,i,o,r,d,c,g,u;switch(x.scale){case"hours":o=Y.genId(Y.dateDeserialize(t.from),v.scaleStep),n=F(v).find("#dh-"+o),r=Y.genId(Y.dateDeserialize(t.to),v.scaleStep),l=F(v).find("#dh-"+r),s=n.data("offset"),i=l.data("offset"),d=Math.floor((i-s)/m)+1,c=100*(m*d-1)/b,a=N.createProgressBar(t.label,t.desc,t.customClass,t.dataObj),g=F(v).find("#rowheader"+f),u=5*m+y+g.data("offset"),a.css({top:u,left:Math.floor(s),width:c+"%"}),w.append(a);break;case"weeks":o=Y.dateDeserialize(t.from),r=Y.dateDeserialize(t.to),s=(n=F(v).find("#"+o.getWeekId())).data("offset"),i=(l=F(v).find("#"+r.getWeekId())).data("offset"),d=Math.round((i-s)/m)+1,c=100*(m*d-1)/b,a=N.createProgressBar(t.label,t.desc,t.customClass,t.dataObj),g=F(v).find("#rowheader"+f),u=3*m+y+g.data("offset"),a.css({top:u,left:Math.floor(s),width:c+"%"}),w.append(a);break;case"months":o=Y.dateDeserialize(t.from),r=Y.dateDeserialize(t.to),o.getDate()<=3&&0===o.getMonth()&&o.setDate(o.getDate()+4),o.getDate()<=3&&0===o.getMonth()&&o.setDate(o.getDate()+4),r.getDate()<=3&&0===r.getMonth()&&r.setDate(r.getDate()+4),s=(n=F(v).find("#dh-"+Y.genId(o))).data("offset"),i=(l=F(v).find("#dh-"+Y.genId(r))).data("offset"),d=Math.round((i-s)/m)+1,c=100*(m*d-1)/b,a=N.createProgressBar(t.label,t.desc,t.customClass,t.dataObj),g=F(v).find("#rowheader"+f),u=2*m+y+g.data("offset"),a.css({top:u,left:Math.floor(s),width:c+"%"}),w.append(a);break;case"days":default:o=Y.genId(Y.dateDeserialize(t.from)),r=Y.genId(Y.dateDeserialize(t.to)),s=(n=F(v).find("#dh-"+o)).data("offset"),d=Math.round((r-o)/864e5)+1,c=100*(m*d-1)/b,a=N.createProgressBar(t.label,t.desc,t.customClass,t.dataObj),g=F(v).find("#rowheader"+f),u=4*m+y+g.data("offset"),a.css({top:u,left:Math.floor(s),width:c+"%"}),w.append(a)}var h=a.find(".fn-label");if(h.length){var p=function(e){try{var t=(e=e.replace("rgb(","").replace(")","")).split(","),a=parseInt(t[0],10),n=parseInt(t[1],10),l=parseInt(t[2],10),s=Math.round(.9*(255-(.299*a+.587*n+.114*l)));return"rgb("+s+", "+s+", "+s+")"}catch(e){return""}}(a.css("backgroundColor"));h.css("color",p)}})});var a=0;F.each(F(".row.header"),function(){a+=this.clientHeight}),w.css({float:"left",height:"calc(100% - "+a+"px)",width:"100%"})},navigateTo:function(e,t){function a(){N.repositionLabel(e)}var n,l,s=F(e).find(".fn-gantt .rightPanel"),i=s.find(".dataPanel"),o=s.width(),r=i.width();switch(t){case"begin":i.animate({left:"0"},"fast",a),e.scrollNavigation.panelMargin=0;break;case"end":var d=r-o;e.scrollNavigation.panelMargin=-1*d,i.animate({left:"-"+d},"fast",a);break;case"now":if(!e.scrollNavigation.canScroll||!i.find(".today").length)return!1;n=-1*(r-o),l=i.css("left").replace("px",""),t=i.find(".today").offset().left-i.offset().left,0<(t*=-1)?t=0:t<n&&(t=n),i.animate({left:t},"fast",a),e.scrollNavigation.panelMargin=t;break;default:n=-1*(r-o),l=i.css("left").replace("px",""),(t=parseInt(l,10)+t)<=0&&n<=t&&i.animate({left:t},"fast",a),e.scrollNavigation.panelMargin=t}N.synchronizeScroller(e)},navigatePage:function(e,t){0<=e.pageNum+t&&e.pageNum+t<Math.ceil(e.rowsNum/x.itemsPerPage)&&N.waitToggle(e,function(){e.pageNum+=t,e.hPosition=F(".fn-gantt .dataPanel").css("left").replace("px",""),e.scaleOldWidth=!1,N.init(e)})},zoomInOut:function(i,o){N.waitToggle(i,function(){var e=o<0,t=i.scaleStep+3*o;t={4:3,5:6,9:8,11:12}[t]||(t<1?1:t);var a=x.scale,n=i.headerRows;if("hours"===x.scale&&13<=t?(a="days",n=4,t=13):"days"===x.scale&&e?(a="hours",n=5,t=12):"days"!==x.scale||e?"weeks"!==x.scale||e?"weeks"===x.scale&&e?(a="days",n=4,t=13):"months"===x.scale&&e&&(a="weeks",n=3,t=13):(a="months",n=2,t=14):(a="weeks",n=3,t=13),e&&F.inArray(a,r)<F.inArray(x.minScale,r)||!e&&F.inArray(a,r)>F.inArray(x.maxScale,r))N.init(i);else{i.scaleStep=t,x.scale=a,i.headerRows=n;var l=F(i).find(".fn-gantt .rightPanel"),s=l.find(".dataPanel");i.hPosition=s.css("left").replace("px",""),i.scaleOldWidth=s.width()-l.width(),x.useCookie&&(F.cookie(x.cookieKey+"CurrentScale",x.scale),F.cookie(x.cookieKey+"ScrollPos",null)),N.init(i)}})},mouseScroll:function(e,t){var a=F(e).find(".fn-gantt .dataPanel");a.css("cursor","move");a.offset();var n=null===e.scrollNavigation.mouseX?t.pageX:e.scrollNavigation.mouseX,l=t.pageX-n;e.scrollNavigation.mouseX=t.pageX,N.scrollPanel(e,l),clearTimeout(e.scrollNavigation.repositionDelay),e.scrollNavigation.repositionDelay=setTimeout(N.repositionLabel,50,e)},wheelScroll:function(e,t){t.preventDefault();var a="detail"in t?t.detail:"wheelDelta"in t.originalEvent?-1/120*t.originalEvent.wheelDelta:t.originalEvent.deltaY?t.originalEvent.deltaY/Math.abs(t.originalEvent.deltaY):t.originalEvent.detail;N.scrollPanel(e,-50*a),clearTimeout(e.scrollNavigation.repositionDelay),e.scrollNavigation.repositionDelay=setTimeout(N.repositionLabel,50,e)},sliderScroll:function(e,t){var a,n,l=F(e).find(".nav-slider-bar"),s=l.find(".nav-slider-button"),i=F(e).find(".fn-gantt .rightPanel"),o=i.find(".dataPanel"),r=l.offset(),d=l.width(),c=s.width();if(t.pageX>=r.left&&t.pageX<=r.left+d){a=t.pageX-r.left,a-=c/2,s.css("left",a);var g=a*(n=o.width()-i.width())/d*-1;0<=g?(o.css("left","0"),e.scrollNavigation.panelMargin=0):d-1*c<=a?(o.css("left",-1*n),e.scrollNavigation.panelMargin=-1*n):(o.css("left",g),e.scrollNavigation.panelMargin=g),clearTimeout(e.scrollNavigation.repositionDelay),e.scrollNavigation.repositionDelay=setTimeout(N.repositionLabel,5,e)}},scrollPanel:function(e,t){if(!e.scrollNavigation.canScroll)return!1;var a=parseInt(e.scrollNavigation.panelMargin,10)+t;0<a?e.scrollNavigation.panelMargin=0:a<-1*e.scrollNavigation.panelMaxPos?e.scrollNavigation.panelMargin=-1*e.scrollNavigation.panelMaxPos:e.scrollNavigation.panelMargin=a,F(e).find(".fn-gantt .dataPanel").css("left",e.scrollNavigation.panelMargin),N.synchronizeScroller(e)},synchronizeScroller:function(e){if("scroll"===x.navigate){var t=F(e).find(".fn-gantt .rightPanel"),a=t.find(".dataPanel"),n=F(e).find(".nav-slider-bar"),l=n.find(".nav-slider-button"),s=n.width(),i=l.width(),o=a.width()-t.width(),r=a.css("left")||0,d=(r=r&&r.replace("px",""))*s/o-.25*l.width();d=0<d?0:s-.75*i<=-1*d?-1*(s-1.25*i):d,l.css("left",-1*d)}},repositionLabel:function(t){setTimeout(function(){var e;t?e=F(t).find(".fn-gantt .rightPanel").find(".dataPanel"):e=F(".fn-gantt .rightPanel .dataPanel");x.useCookie&&F.cookie(x.cookieKey+"ScrollPos",e.css("left").replace("px",""))},500)},waitToggle:function(e,t){if(F.isFunction(t)){var a=F(e);a.offset(),a.outerWidth(),a.outerHeight();e.loader||(e.loader=F('<div class="fn-gantt-loader"><div class="fn-gantt-loader-spinner"><span>'+x.waitText+"</span></div></div>")),a.append(e.loader),setTimeout(t,500)}else e.loader&&e.loader.detach()}},Y={getMaxDate:function(e){var t,a=null;switch(F.each(e.data,function(e,t){F.each(t.values,function(e,t){a=a<Y.dateDeserialize(t.to)?Y.dateDeserialize(t.to):a})}),a=a||new Date,x.scale){case"hours":a.setHours(Math.ceil(a.getHours()/e.scaleStep)*e.scaleStep),a.setHours(a.getHours()+3*e.scaleStep);break;case"weeks":t=new Date(a.getTime()),t=new Date(t.setDate(t.getDate()+21));var n=7*Math.floor(t.getDate()/7);a=new Date(t.getFullYear(),t.getMonth(),0==n?4:n-3);break;case"months":(t=new Date(a.getFullYear(),a.getMonth(),1)).setMonth(t.getMonth()+2),a=new Date(t.getFullYear(),t.getMonth(),1);break;case"days":default:a.setHours(0),a.setDate(a.getDate()+3)}return a},getMinDate:function(e){var a=null;switch(F.each(e.data,function(e,t){F.each(t.values,function(e,t){a=a>Y.dateDeserialize(t.from)||null===a?Y.dateDeserialize(t.from):a})}),a=a||new Date,x.scale){case"hours":a.setHours(Math.floor(a.getHours()/e.scaleStep)*e.scaleStep),a.setHours(a.getHours()-3*e.scaleStep);break;case"weeks":var t=new Date(a.getTime());t=new Date(t.setDate(t.getDate()-21));var n=7*Math.floor(t.getDate()/7);a=new Date(t.getFullYear(),t.getMonth(),0==n?4:n-3);break;case"months":a.setHours(0,0,0,0),a.setDate(1),a.setMonth(a.getMonth()-3);break;case"days":default:a.setHours(0,0,0,0),a.setDate(a.getDate()-3)}return a},parseDateRange:function(e,t){for(var a=e.getFullYear(),n=e.getMonth(),l=e.getDate(),s=[],i=0;s[i]=new Date(a,n,l+i),s[i++]<t;);return s},parseTimeRange:function(e,t,a){var n=e.getFullYear(),l=e.getMonth(),s=e.getDate(),i=e.getHours();i-=i%a;for(var o=[],r=0,d=0;o[d]=new Date(n,l,s,i+r++*a),0<d&&o[d].getHours()===o[d-1].getHours()&&d--,o[d++]<t;);return o},parseWeeksRange:function(e,t){for(var a=e.getDayForWeek(),n=[],l=0;n[l++]=a.getDayForWeek(),a.setDate(a.getDate()+7),a<=t;);return n},parseMonthsRange:function(e,t){for(var a=new Date(e),n=(new Date(t),[]),l=0;n[l++]=new Date(a.getFullYear(),a.getMonth(),1),a.setMonth(a.getMonth()+1),a<=t;);return n},dateDeserialize:function(e){return"string"==typeof e&&(e=e.replace(/\/Date\((.*)\)\//,"$1"),e=F.isNumeric(e)?parseInt(e,10):F.trim(e)),new Date(e)},makeBarDraggable:function(e){e.draggable({containment:"parent",start:function(e,t){F(this).data("startx",F(this).css("left").split("px")[0]),F(this).data("starty",F(this).css("top").split("px")[0])},stop:function(e,t){parseInt(F(this).css("left").split("px")[0]),parseInt(F(this).data("startx"));var a=parseInt(F(this).css("top").split("px")[0]);a-=a%24,F(this).css("top",a);parseInt(F(this).data("starty"))}})},makeBarResizable:function(e){e.resizable({handles:"e, w"})},genId:function(e){switch(F.isNumeric(e)&&(e=new Date(e)),x.scale){case"hours":var t=e.getHours();return 2<=arguments.length&&(t=Math.floor(e.getHours()/arguments[1])*arguments[1]),new Date(e.getFullYear(),e.getMonth(),e.getDate(),t).getTime();case"weeks":var a=e.getFullYear(),n=e.getWeekOfYear(),l=e.getMonth();return 11===l&&1===n?a++:!l&&51<n&&a--,a+"-"+n;case"months":return e.getFullYear()+"-"+e.getMonth();case"days":default:return new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime()}},_datesToDays:function(e){for(var t={},a=0,n=e.length;a<n;a++)t[Y.dateDeserialize(e[a]).setHours(0,0,0,0)]=!0;return t},isHoliday:function(){if(!x.holidays||!x.holidays.length)return function(){return!1};var t=!1;return function(e){return!!(t=t||Y._datesToDays(x.holidays))[F.isNumeric(e)?e:new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime()]}}(),getCellSize:function(){if(void 0===Y._getCellSize){var e=F('<div style="display: none; position: absolute;" class="fn-gantt"><div class="row"></div></div>');F("body").append(e),Y._getCellSize=e.find(".row").height(),e.empty().remove()}return Y._getCellSize},getPageHeight:function(e){return e.pageNum+1===e.pageCount?e.rowsOnLastPage*Y.getCellSize():x.itemsPerPage*Y.getCellSize()}};this.each(function(){if(this.data=null,this.pageNum=0,this.pageCount=0,this.rowsOnLastPage=0,this.rowsNum=0,this.hPosition=0,this.dateStart=null,this.dateEnd=null,this.scrollClicked=!1,this.scaleOldWidth=null,this.headerRows=null,x.useCookie){var e=F.cookie(x.cookieKey+"CurrentScale");e?x.scale=e:F.cookie(x.cookieKey+"CurrentScale",x.scale)}switch(x.scale){case"hours":this.headerRows=5,this.scaleStep=1;break;case"weeks":this.headerRows=3,this.scaleStep=13;break;case"months":this.headerRows=2,this.scaleStep=14;break;case"days":default:this.headerRows=4,this.scaleStep=13}this.scrollNavigation={panelMouseDown:!1,scrollerMouseDown:!1,mouseX:null,panelMargin:0,repositionDelay:0,panelMaxPos:0,canScroll:!0},this.gantt=null,this.loader=null,N.create(this)})}}(jQuery);